#!/bin/sh

# When switching to bsp layout on a dual monitor setup, center the two largest
# windows right in front of me, i.e., the left monitor with the largest window
# on the right, and the right monitor with it on the left.

display=$(yabai -m query --spaces --space | jq -r .display)

if [ "$1" = "bsp" ]
then
    if [ "$display" = "1" ]
    then
      yabai -m space --layout bsp && yabai -m space --mirror y-axis && yabai -m window --swap largest
    elif [ "$display" = "2" ]
    then
      # Need the || below to handle "cannot swap a window with itself" when there are only
      # two windows. Only happens on the left monitor.
      yabai -m space --layout bsp && yabai -m window --swap largest || yabai -m window --swap next
    else
      exit 1
    fi
else
    exit 1
fi
